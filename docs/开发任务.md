# 开发任务清单

## 阶段一: 核心框架与管理后台基础功能 (Admin Panel - Core Management)

- [x] **1. 项目初始化与基础架构搭建 (Nuxt 3)**
  - 描述：包含整体项目结构规划, Admin Panel (SPA) 基础布局与路由设计, 全局样式与交互规范制定, 公共组件库(Element Plus)集成与基础组件封装,工具类封装, Pinia状态管理集成, 数据库(MySQL)与ORM(Prisma)配置
  - 输入：技术选型、PRD、技术文档
  - 输出：可运行的 Nuxt 3 项目骨架，包含基础配置和集成
  - 依赖：无

- [x] **2. 用户认证模块 (简化版 - 登录、登出、状态保持)**
  - 描述：实现单用户的登录、登出及登录状态保持功能。
  - 输入：用户凭证（预设或简单注册）
  - 输出：认证通过后的用户会话或 token，受保护的路由
  - 依赖：阶段一任务1
  - **✅ 已完成**：登录页面、认证API、中间件保护、默认用户创建

- [x] **3. 数据库核心表设计与 Prisma Schema 实现**
  - 描述：根据技术文档中的表设计，完成 Prisma Schema 定义，并生成初始数据库迁移。涉及 users, domains, domain_categories, domain_tags, domain_costs, portfolios, portfolio_domain_map, inquiries, registrars, ai_prompts, system_settings, watched_domains 等表。
  - 输入：技术文档中的数据库表设计
  - 输出：Prisma Schema 文件，数据库成功应用迁移
  - 依赖：阶段一任务1

- [x] **4. 注册商管理 CRUD API & 后台界面**
  - 描述：实现注册商信息的增删改查 API 接口及对应的后台管理界面。
  - 输入：注册商名称、网址等信息
  - 输出：可用的注册商管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：完整CRUD API、后台管理界面、搜索分页、表单验证

- [x] **5. 域名分类管理 CRUD API & 后台界面**
  - 描述：实现域名分类信息的增删改查 API 接口及对应的后台管理界面。
  - 输入：分类名称、描述
  - 输出：可用的域名分类管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：完整CRUD API、Joi数据验证、ResponseData标准返回、依赖检查

- [x] **6. 域名标签管理 CRUD API & 后台界面**
  - 描述：实现域名标签信息的增删改查 API 接口及对应的后台管理界面。
  - 输入：标签名称
  - 输出：可用的域名标签管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：完整CRUD API、Joi数据验证、ResponseData标准返回、依赖检查、前端界面

- [x] **7. 域名信息管理 CRUD API & 后台界面**
  - 描述：实现域名核心信息的增删改查 API 接口及后台管理界面，包括手动录入、编辑、删除、列表展示、筛选、排序功能。
  - 输入：域名、注册商、日期、成本、分类、标签等信息
  - 输出：可用的域名信息管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3, 4, 5, 6
  - **✅ 已完成**：域名CRUD API、前端管理界面、搜索过滤、标签关联、数据验证、错误处理

- [x] **8. 域名花费管理 API & 后台界面**
  - 描述：实现记录和管理单个域名相关的成本（如购买、续费）的 API 及后台界面。
  - 输入：域名ID、成本金额、日期、类型
  - 输出：可用的域名成本管理 API，后台可操作的界面
  - 依赖：阶段一任务7
  - **✅ 已完成**：完整CRUD API、成本统计、前端界面、数据验证

- [x] **9. WHOIS 查询工具集成 (调用 api.tian.hu) 与后台界面**
  - 描述：集成外部 WHOIS 查询服务 (api.tian.hu)，提供后台界面供用户查询，并辅助域名录入。
  - 输入：待查询的域名
  - 输出：查询到的 WHOIS 信息展示，域名录入时的信息填充辅助
  - 依赖：阶段一任务1
  - **✅ 已完成**：WHOIS查询API、前端界面、自动填充功能、结果展示

- [ ] **10. 域名价格参考查询集成 (调用 api.tian.hu)**
  - 描述：集成外部域名价格参考服务 (api.tian.hu)，在域名录入或详情页展示价格参考。
  - 输入：待查询价格的域名
  - 输出：查询到的域名价格参考信息展示
  - 依赖：阶段一任务1, 7

- [x] **11. 域名关注模块 CRUD API & 后台界面**
  - 描述：实现用户关注非自有域名的增删改查 API 及后台管理界面。
  - 输入：待关注的域名、备注
  - 输出：可用的域名关注管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3, 9 (可能用于获取关注域名的初始信息)
  - **✅ 已完成**：完整CRUD API、关注域名列表管理、搜索过滤、监控级别配置、通知设置、前端界面、数据验证

- [x] **12. 线索管理 CRUD API & 后台界面**
  - 描述：实现管理访客线索的 API 及后台界面，包括列表展示、查看详情、状态更新。
  - 输入：线索信息（来自前端提交）
  - 输出：可用的线索管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：线索列表查询API、状态更新API、批量删除API、详情查询API、状态选项API、前端管理界面、状态管理、详情查看

- [x] **13. 系统配置 - AI 服务配置 (API Key) 后台界面与后端逻辑**
  - 描述：实现允许用户配置第三方 AI 服务 API Key 的后台界面及后端存储逻辑。
  - 输入：用户提供的 AI 服务商名称、API Key
  - 输出：后台可配置 AI API Key 的界面，配置信息安全存储
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：AI服务配置API、多服务商支持、安全存储、前端管理界面、连接测试、配置帮助

- [x] **14. AI 提示词管理 CRUD API & 后台界面**
  - 描述：实现管理不同 AI 功能场景下系统提示词和用户自定义提示词的 API 及后台界面。
  - 输入：场景标识、场景名称、系统提示词、用户自定义提示词
  - 输出：可用的 AI 提示词管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：提示词CRUD API、12个预定义AI场景、多模型支持、自定义提示词管理、前端界面、搜索过滤、批量操作

- [x] **15. 系统配置 - 基础配置项管理 API & 后台界面**
  - 描述：实现管理系统基础配置项（如界面个性化部分占位、通知类型占位等）的 API 及后台界面。
  - 输入：配置项键、配置项值
  - 输出：可用的基础配置管理 API，后台可操作的界面
  - 依赖：阶段一任务1, 3
  - **✅ 已完成**：配置项CRUD API、多种值类型支持（文本、数字、布尔、选择器、多行文本、JSON）、分类管理、排序权重、验证规则、前端管理界面、搜索过滤、批量操作

🎉 **阶段一开发完成！** 🎉

已完成阶段一全部15个任务，实现了完整的域名管理系统核心功能：

**✅ 基础设施**：项目初始化、用户认证、权限管理
**✅ 基础数据管理**：注册商、域名分类、域名标签
**✅ 核心业务**：域名信息管理、域名花费管理  
**✅ 扩展功能**：WHOIS查询、域名关注、线索管理
**✅ 智能化功能**：AI服务配置、AI提示词管理
**✅ 系统设置**：可视化系统配置面板

系统已具备完整的域名投资管理能力，可以正式投入使用。

---

## 阶段二: 管理后台 - 定制化功能、数据分析与 AI 辅助 (Admin Panel - Advanced Features & AI)

- [x] **1. 综合分析仪表盘 (管理后台首页) 设计与后端 API**
  - 描述：设计并实现管理后台首页的综合分析仪表盘，展示核心 KPI 和快捷入口，并提供相应后端 API。
  - 输入：各模块数据
  - 输出：后台首页仪表盘界面，数据聚合 API
  - 依赖：阶段一各模块数据源
  - **✅ 已完成**：创建了3个仪表盘API（stats、activities、overview），提供统计数据、最近活动、综合概览等功能，前端界面展示核心KPI、快捷入口、活动流、到期提醒等模块，采用响应式设计，使用统一的ResponseData返回格式

- [x] **2. 销售报表 API & 后台界面**
  - 描述：实现销售报表的后端 API 及后台展示界面，包括已售列表、业绩统计、利润分析。
  - 输入：已售域名数据、成本数据
  - 输出：销售报表 API，后台报表展示界面
  - 依赖：阶段一任务7, 8, 12 (线索状态可能关联销售)
  - **✅ 已完成**：新增DomainSale数据模型、销售记录列表API、销售统计分析API、销售记录CRUD API、响应式前端界面、利润计算、搜索过滤、分页功能

- [x] **3. 成本报表 API & 后台界面**
  - 描述：实现成本报表的后端 API 及后台展示界面，包括成本追踪、总持有成本、续费预测。
  - 输入：域名成本数据
  - 输出：成本报表 API，后台报表展示界面
  - 依赖：阶段一任务8
  - **✅ 已完成**：成本统计分析API、成本记录列表API、成本记录CRUD API、选项数据API、响应式前端界面、成本类型分布图表、月度成本趋势、持有成本计算、续费预测、搜索过滤、分页功能、批量操作、与注册商页面保持一致的UI风格

- [x] **. 着陆页配置管理系统**
  - 描述：实现完整的着陆页配置管理系统，支持单个域名配置、预览效果、默认配置等功能。
  - 输入：域名ID、着陆页模板、自定义内容、价格、联系信息
  - 输出：着陆页配置管理页面、预览功能、API接口
  - 依赖：阶段一任务7
  - **✅ 已完成**：
    - 默认着陆页配置管理页面 (`pages/admin/system/landing.vue`)
    - 系统级配置API接口（保存配置、获取配置）
    - 参考截图实现的完整配置选项（主题、背景、字体、出售选项等）
    - 实时预览功能（桌面端、移动端预览模式）
    - 配置保存、重置、导出功能
    - 与系统管理模块集成，支持中英文国际化

- [x] **. 米表管理 API & 后台界面**
  - 描述：实现后台管理米表（Portfolio）的功能，包括默认米表逻辑、自定义米表 CRUD、域名选择关联、外观配置及相应 API。
  - 输入：米表名称、slug、关联域名、显示配置
  - 输出：米表管理 API，后台管理界面
  - 依赖：阶段一任务7

- [x] **4. AI 服务适配层后端实现**
  - 描述：实现统一的 AI 服务适配层，用于调用用户配置的第三方大模型服务。
  - 输入：用户配置的 API Key、待处理数据、场景提示词
  - 输出：调用第三方 AI 服务并返回结果的统一接口
  - 依赖：阶段一任务13, 14

- [x] **5. 集成各项 AI 辅助功能到域名管理**
  - 描述：将 AI 辅助功能（如标签建议、描述生成、域名分析等）集成到域名管理流程中。
  - 输入：域名信息、用户操作上下文
  - 输出：域名管理界面中嵌入的 AI 辅助功能
  - 依赖：阶段一任务7, 阶段二任务4

- [x] **6. ChatBot 后端 API (WebSocket/HTTP) 与前端悬浮组件实现**
  - 描述：实现 ChatBot 的后端通信 API (推荐 WebSocket) 及前端悬浮聊天组件。
  - 输入：用户聊天输入、上下文
  - 输出：可交互的 ChatBot 功能
  - 依赖：阶段二任务4

- [ ] **7. 访问与线索分析 API & 后台界面**
  - 描述：实现基础 PV/UV、线索统计的 API 及后台界面，并集成 AI 驱动的异常流量检测、线索内容智能分析。
  - 输入：前端页面访问日志（需规划如何收集）、线索数据
  - 输出：访问与线索分析报表 API，后台界面
  - 依赖：阶段一任务12, 阶段二任务4, ToC 门户的访问数据

- [ ] **8. 到期管理与提醒 (后台定时任务 `node-cron` 与邮件/系统内通知)**
  - 描述：实现域名到期前通过后台定时任务发送邮件和系统内通知的提醒功能。
  - 输入：域名到期日期、用户通知设置
  - 输出：到期提醒邮件、系统内通知
  - 依赖：阶段一任务7, 系统邮件服务配置

## 阶段三: 公开展示门户 (ToC - Public Facing Portal)

- [x] **1. ToC 端 Nuxt 3 SSR/SSG 基础搭建与布局**
  - 描述：搭建公开展示门户的 Nuxt 3 项目基础，采用 SSR/SSG 模式，并设计基础布局。
  - 输入：技术选型、PRD
  - 输出：可运行的 ToC Nuxt 3 项目骨架
  - 依赖：无 (可与阶段一并行，但最终会依赖阶段一接口)

- [x] **4. ToC 单域名着陆页动态渲染 (SSR/SSG, 响应 Host 自动匹配域名)**
  - 描述：实现 ToC 门户根据访问的域名 (Host) 动态渲染对应的单域名着陆页。
  - 输入：HTTP 请求 (Host)
  - 输出：服务端渲染的单域名着陆页 HTML
  - 依赖：阶段三任务1, 2, 域名 DNS 配置正确指向服务器
  - **✅ 已完成**：
    - 单域名着陆页动态渲染 (`pages/domains/[domain].vue`)
    - 根据后端配置支持多种显示模式（自定义内容、预设模板、重定向）
    - 完善的SEO优化（动态Meta标签、Open Graph、Twitter Card）
    - 动态SEO图片生成API (`server/api/portal/seo-image.get.ts`)
    - 社交媒体分享优化（自动生成分享预览卡片）
    - 响应式设计，适配移动端和桌面端
    - 域名点击行为处理（跳转到着陆页、显示询价弹窗、跳转到外部链接）

- [x] **5. ToC 米表页面动态渲染 (SSR/SSG, 响应自定义 slug)**
  - 描述：实现 ToC 门户根据访问的 slug 动态渲染对应的米表页面。
  - 输入：HTTP 请求 (URL slug)
  - 输出：服务端渲染的米表页面 HTML
  - 依赖：阶段三任务1, 3

- [x] **6. ToC 线索表单提交与后端处理**
  - 描述：实现 ToC 门户上线索表单的提交功能，并将数据传递给后端线索管理模块。
  - 输入：访客姓名、邮箱、消息等
  - 输出：线索成功提交，数据进入线索管理系统
  - 依赖：阶段一任务12 (线索API), 阶段三任务4, 5

- [ ] **7. (并行) Nginx 配置自定义域名绑定方案与 SSL (Let's Encrypt) 集成实现**
  - 描述：配置 Nginx 以支持用户自定义域名绑定到其单域名着陆页或米表，并集成 Let's Encrypt 实现 SSL 证书自动申请与续签。
  - 输入：用户绑定的域名、系统部署结构
  - 输出：Nginx 配置，可访问的自定义 HTTPS 域名
  - 依赖：服务器环境，Certbot 等工具

- [ ] **8. ToC 端多语言支持实现 (i18n)**
  - 描述：为 ToC 门户实现多语言支持 (如中/英)。
  - 输入：翻译文本资源
  - 输出：可切换语言的 ToC 门户
  - 依赖：阶段三任务1

- [ ] **9. ToC 端 SEO 优化与社交媒体预览卡片**
  - 描述：对 ToC 门户进行 SEO 优化，包括动态 Meta 标签、结构化数据、sitemap.xml, robots.txt 生成，以及社交媒体分享预览卡片。
  - 输入：各页面内容和元数据
  - 输出：优化 SEO 的 ToC 门户页面
  - 依赖：阶段三任务4, 5

## 阶段四: 系统完善、测试与部署准备

- [ ] **1. 系统配置 - 完整实现 API & 后台界面**
  - 描述：完成所有系统配置项的后端 API 和后台管理界面，如数据导出备份 (XLSX/DB Dump)、账户安全等。
  - 输入：配置项具体需求
  - 输出：完整的系统配置功能
  - 依赖：阶段一任务15 及各项具体配置依赖的模块

- [ ] **2. 全面集成测试**
  - 描述：对系统所有模块进行全面的集成测试，确保各模块联动正常，端到端流程通畅。
  - 输入：测试用例
  - 输出：测试报告，Bug 列表
  - 依赖：所有已开发完成的模块

- [ ] **3. Bug 修复与性能优化**
  - 描述：根据测试结果修复 Bug，并对数据库查询、API 响应、前端加载等方面进行性能优化。
  - 输入：Bug 列表、性能分析报告
  - 输出：更稳定、更高性能的系统版本
  - 依赖：阶段四任务2

- [ ] **4. 安全性加固**
  - 描述：对系统进行安全性加固，包括输入验证、XSS 防护、CSRF 防护、API 限流等。
  - 输入：安全风险评估、已知漏洞类型
  - 输出：增强安全性的系统版本
  - 依赖：系统现有代码

- [ ] **5. 用户手册与部署文档编写**
  - 描述：编写详细的用户手册和系统部署文档。
  - 输入：系统功能、部署流程
  - 输出：用户手册文档、部署文档
  - 依赖：系统最终功能形态

- [ ] **6. 生产环境部署与最终验证**
  - 描述：将系统部署到生产环境，并进行最终的功能和稳定性验证。
  - 输入：部署文档、生产环境
  - 输出：成功上线的 DMS 系统
  - 依赖：阶段四任务5, 完成所有准备工作
